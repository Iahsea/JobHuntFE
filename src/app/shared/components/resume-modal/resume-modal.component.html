<div class="resume-modal">
    <!-- Header -->
    <div class="modal-header">
        <div class="header-left">
            <div class="company-logo">
                @if (data.job.company?.logo) {
                <img [src]="data.job.company?.logo"
                     [alt]="data.job.company?.name" />
                } @else {
                <mat-icon>business</mat-icon>
                }
            </div>
            <div class="job-info">
                <h2 class="job-title">{{ data.job.name }}</h2>
                <p class="company-details">
                    {{ data.job.company?.name }} â€¢ {{ data.job.location }}
                </p>
            </div>
        </div>
        <button mat-icon-button
                (click)="onCancel()"
                class="close-button">
            <mat-icon>close</mat-icon>
        </button>
    </div>


    <!-- Body -->
    <div class="modal-body">
        <h3 class="form-title">Submit Application</h3>
        <p class="form-subtitle">Fill in your information to apply for this position</p>

        <form [formGroup]="resumeForm"
              (ngSubmit)="onSubmit()"
              class="application-form">

            <!-- Email -->
            <div class="w-full">
                <label for="email"
                       class="block text-sm font-medium text-gray-700 mb-1">Email<span
                          class="text-red-500">*</span></label>
                <div class="relative">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-400">
                        <mat-icon>email</mat-icon>
                    </span>
                    <input id="email"
                           type="email"
                           formControlName="email"
                           placeholder="john@example.com"
                           class="pl-10 pr-3 py-2 border border-gray-300 rounded-md w-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-gray-900"
                           [class.border-red-500]="resumeForm.get('email')?.invalid && resumeForm.get('email')?.touched" />
                </div>
                @if (resumeForm.get('email')?.invalid && resumeForm.get('email')?.touched) {
                <div class="text-xs text-red-500 mt-1">
                    Email is required
                </div>
                }
            </div>


            <!-- Resume Upload -->
            <div class="upload-section">
                <label class="upload-label">Upload Resume/CV</label>
                <input type="file"
                       #fileInput
                       (change)="onFileSelected($event)"
                       accept=".pdf,.doc,.docx"
                       class="hidden" />

                @if (!selectedFile) {
                <button type="button"
                        mat-stroked-button
                        (click)="fileInput.click()"
                        class="upload-button">
                    <mat-icon>cloud_upload</mat-icon>
                    <span>Choose File</span>
                </button>
                } @else {
                <div class="selected-file">
                    <div class="file-info">
                        <mat-icon class="file-icon">description</mat-icon>
                        <div class="file-details">
                            <p class="file-name">{{ selectedFile.name }}</p>
                            <p class="file-size">{{ (selectedFile.size / 1024).toFixed(2) }} KB</p>
                        </div>
                    </div>
                    <button type="button"
                            mat-icon-button
                            (click)="removeFile($event)"
                            class="remove-button">
                        <mat-icon>close</mat-icon>
                    </button>
                </div>
                }
                <p class="upload-hint">PDF, DOC, DOCX - Max 5MB</p>
            </div>

            <!-- Actions -->
            <div class="form-actions">
                <button type="button"
                        mat-stroked-button
                        (click)="onCancel()"
                        class="cancel-button">
                    Cancel
                </button>
                <button type="submit"
                        mat-raised-button
                        color="primary"
                        [disabled]="isSubmitting || resumeForm.invalid || !selectedFile"
                        class="submit-button">
                    @if (isSubmitting) {
                    <mat-spinner diameter="20"
                                 class="mr-2"></mat-spinner>
                    <span>Submitting...</span>
                    } @else {
                    <span>Submit Application</span>
                    }
                </button>
            </div>
        </form>
    </div>
</div>